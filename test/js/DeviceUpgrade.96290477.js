(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["DeviceUpgrade"],{"3eb0":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticStyle:{"box-sizing":"border-box"}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(e.$t("deviceUpgrade.searchTitle")))])]),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,"label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.searchForm.label")[0]}},[a("el-input",{attrs:{placeholder:e.$t("deviceUpgrade.searchForm.placeholder")[0]},model:{value:e.formInline.ICCID,callback:function(t){e.$set(e.formInline,"ICCID",t)},expression:"formInline.ICCID"}})],1),a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.searchForm.label")[1]}},[a("el-input",{attrs:{placeholder:e.$t("deviceUpgrade.searchForm.placeholder")[1]},model:{value:e.formInline.IDS,callback:function(t){e.$set(e.formInline,"IDS",t)},expression:"formInline.IDS"}})],1),a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.searchForm.label")[2]}},[a("el-input",{attrs:{placeholder:e.$t("deviceUpgrade.searchForm.placeholder")[2]},model:{value:e.formInline.VIN,callback:function(t){e.$set(e.formInline,"VIN",t)},expression:"formInline.VIN"}})],1),a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.searchForm.label")[3]}},[a("el-input",{attrs:{placeholder:e.$t("deviceUpgrade.searchForm.placeholder")[3]},model:{value:e.formInline.Name,callback:function(t){e.$set(e.formInline,"Name",t)},expression:"formInline.Name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.formInline.page=1,e.getData()}}},[e._v(e._s(e.$t("base.searchbtn")))])],1)],1)],1),a("div",{staticStyle:{height:"20px",width:"100%"}})],1)]),a("el-card",{staticClass:"box-card visible"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(e.$t("deviceUpgrade.listTitle")))])]),a("vxe-toolbar",{attrs:{custom:"",print:"",export:""},scopedSlots:e._u([{key:"buttons",fn:function(){return[a("el-button",{staticClass:"button-left",attrs:{type:"primary",size:"small"},on:{click:e.getData}},[a("i",{staticClass:"el-icon-refresh-right"}),e._v(" "+e._s(e.$t("base.refresh"))+" ")]),a("el-button",{staticClass:"button-left",attrs:{type:"primary",size:"small"},on:{click:function(t){e.isShow=!e.isShow}}},[a("i",{staticClass:"el-icon-search"}),e._v(" "+e._s(e.$t("base.search"))+" ")])]},proxy:!0}])}),a("vxe-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"xTable",attrs:{data:e.tableData,border:"","export-config":e.exportConfig,"element-loading-background":"rgba(0, 0, 0, 0)","edit-config":{trigger:"manual",mode:"row"},resizable:"","highlight-hover-row":"","highlight-current-row":""}},[a("vxe-table-column",{attrs:{type:"checkbox",width:"50",fixed:"left",align:"center"}}),a("vxe-table-column",{attrs:{type:"seq",width:"50",title:e.$t("deviceUpgrade.tableLabel")[0],fixed:"left",align:"center"}}),a("vxe-table-column",{attrs:{field:"DICCID",title:e.$t("deviceUpgrade.tableLabel")[1],sortable:"",width:"300","show-overflow":"","show-header-overflow":""}}),a("vxe-table-column",{attrs:{field:"DIDS",title:e.$t("deviceUpgrade.tableLabel")[2],sortable:"",width:"300","show-overflow":"","show-header-overflow":""}}),a("vxe-table-column",{attrs:{field:"DName",title:e.$t("deviceUpgrade.tableLabel")[3],sortable:"",width:"200","show-overflow":"","show-header-overflow":""}}),a("vxe-table-column",{attrs:{field:"DManageMentUserName",title:e.$t("deviceUpgrade.tableLabel")[4],sortable:"",width:"200","show-overflow":"","show-header-overflow":""}}),a("vxe-table-column",{attrs:{field:"DTime",title:e.$t("deviceUpgrade.tableLabel")[5],width:"250",sortable:"","show-overflow":"","show-header-overflow":""}}),a("vxe-table-column",{attrs:{title:e.$t("deviceUpgrade.tableLabel")[6],align:"center",width:"250","show-header-overflow":""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{attrs:{plain:"",size:"small"},on:{click:function(t){return e.showDialog(i)}}},[a("i",{staticClass:"el-icon-info"},[e._v(e._s(e.$t("deviceUpgrade.operation")[0]))])])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.formInline.page,"page-sizes":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{title:e.$t("deviceUpgrade.operation")[0],visible:e.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[e.show?a("div",{staticStyle:{position:"relative"}},[e.spinShow1?a("Spin",{attrs:{fix:""}}):e._e(),a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.dialog.label")[0],"label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.dialog.label")[1],"label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.devicesystemid,callback:function(t){e.$set(e.form,"devicesystemid",t)},expression:"form.devicesystemid"}})],1),a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.dialog.label")[2],"label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.deviceid,callback:function(t){e.$set(e.form,"deviceid",t)},expression:"form.deviceid"}})],1),a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.dialog.label")[3],"label-width":e.formLabelWidth}},[a("el-select",{on:{change:e.getLabel},model:{value:e.form.target,callback:function(t){e.$set(e.form,"target",t)},expression:"form.target"}},e._l(e.target,(function(e,t){return a("el-option",{key:t,attrs:{value:e.unit,label:e.value}})})),1)],1)],1),a("el-form",{attrs:{inline:!0,id:"upload"}},[a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.dialog.label")[4],"label-width":e.formLabelWidth}},[a("el-input",{attrs:{readonly:"",autocomplete:"off"},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}})],1),a("el-form-item",{attrs:{"label-width":e.formLabelWidth}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:e.baseURL+"/api/File/GetDMSCBootLoader","file-list":e.fileList,"auto-upload":!1,"show-file-list":!1,multiple:!1,data:e.form,"on-success":e.handleSuccess,"on-error":e.handleError,"on-change":e.showFileName}},[a("el-button",{attrs:{type:"primary"},on:{click:e.showFileName}},[e._v(e._s(e.$t("deviceUpgrade.dialog.btn")[0]))])],1)],1)],1)],1):e._e(),e.show?e._e():a("div",[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.dialog.label")[0],"label-width":e.formLabelWidth}},[a("p",[e._v(" "+e._s(e.form.name)+" ")])]),a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.dialog.label")[1],"label-width":e.formLabelWidth}},[a("p",[e._v(" "+e._s(e.form.devicesystemid)+" ")])]),a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.dialog.label")[2],"label-width":e.formLabelWidth}},[a("p",[e._v(" "+e._s(e.form.deviceid)+" ")])]),a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.dialog.label")[3],"label-width":e.formLabelWidth}},[e._v(" "+e._s(e.upgradeTarget)+" ")]),a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.dialog.label")[4],"label-width":e.formLabelWidth}},[a("p",[e._v(" "+e._s(e.fileName)+" ")])]),a("el-form-item",{attrs:{label:e.$t("deviceUpgrade.dialog.label")[5],"label-width":e.formLabelWidth}},[e.successTipShow?a("p",{staticStyle:{color:"#409EFF"}},[e._v(" "+e._s(e.successTip)+" ")]):e._e(),e.successTipShow?e._e():a("p",{staticStyle:{color:"#409EFF"}},[e._v(" "+e._s(e.$t("deviceUpgrade.dialog.unit")[0])+"..."+e._s(e.num)+e._s(e.$t("deviceUpgrade.dialog.unit")[1])+" ")])])],1)],1),e.show?a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("base.cancel")))]),a("el-button",{attrs:{type:"primary",disabled:e.spinShow1},on:{click:e.edit}},[e._v(e._s(e.$t("base.submit")))])],1):e._e(),e.show?e._e():a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(" "+e._s(e.successTipShow?e.$t("deviceUpgrade.dialog.btn")[2]:e.$t("deviceUpgrade.dialog.btn")[1])+" ")])],1)])],1)],1)},l=[],o=a("2f62");function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(a,!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c={data:function(){return{formInline:{page:1,limit:2,ICCID:"",IDS:"",VIN:"",Name:"",AutoSystemID:""},tableData:[],isShow:!0,count:0,loading:!1,form:{AutoSystemID:"",name:"",target:"",deviceid:"",devicesystemid:""},formLabelWidth:"120px",dialogFormVisible:!1,target:[],spinShow1:!1,fileList:[],num:5,show:!0,successTip:"",upgradeTarget:"",successTipShow:!1,baseURL:this.GLOBAL.baseURL,exportConfig:{filename:"export",sheetName:"Sheet1",types:["csv","xlsx"]},fileName:""}},methods:{handleSizeChange:function(e){this.formInline.limit=e,this.getData()},handleCurrentChange:function(e){this.formInline.page=e,this.getData()},showDialog:function(e){this.dialogFormVisible=!0,this.show=!0,this.successTipShow=!1,this.successTip="",this.form={},this.fileName="",this.spinShow1=!0,this.getControllerList(),console.log(e),this.form.devicesystemid=e.SystemID,this.form.deviceid=e.DIDS,this.form.name=e.DName},getData:function(){var e=this;this.loading=!0,this.formInline.AutoSystemID=localStorage.getItem("AutoSystemID"),this.$axios.get("/api/Devices/GetRegistrationEquipmentList?AutoSystemID=".concat(this.formInline.AutoSystemID,"&page=").concat(this.formInline.page,"&limit=").concat(this.formInline.limit,"&ICCID=").concat(this.formInline.ICCID,"&IDS=").concat(this.formInline.IDS,"&VIN=").concat(this.formInline.VIN,"&Name=").concat(this.formInline.Name)).then((function(t){t.data.data?e.tableData=t.data.data:e.tableData=[],e.count=t.data.count,e.loading=!1})).catch((function(e){console.log(e)}))},edit:function(){this.form.AutoSystemID=localStorage.getItem("AutoSystemID"),this.$refs.upload.submit()},getControllerList:function(){var e=this;this.$axios.get("/api/Devices/GetTargetList?AutoSystemID=".concat(this.formInline.AutoSystemID)).then((function(t){0===t.data.code?(e.target=t.data.data.TargetList,e.form.target=e.target[0].unit,e.upgradeTarget=e.target[0].value):e.target=[],setTimeout((function(){e.spinShow1=!1}),500)})).catch((function(e){console.log(e)}))},showFileName:function(e,t){"ready"===e.status&&(this.fileName=e.name)},handleSuccess:function(e,t,a){var i,l=this;0===e.code?(this.show=!1,this.num=20,i=setInterval((function(){l.num>=1?l.num--:(clearInterval(i),l.successCallback(e.callback),l.successTipShow=!0)}),1e3)):2===e.code?(this.$message.error(e.msg),localStorage.removeItem("AutoSystemID"),this.$router.push({path:"/login"})):this.$message.warning(e.msg)},handleError:function(e,t,a){this.form={},this.fileName="",this.$message.error(e.msg)},successCallback:function(e){var t=this;this.$axios.get("/api/Command/GetCallBackInfo?AutoSystemID=".concat(this.formInline.AutoSystemID,"&CallBackSystemID=").concat(e)).then((function(e){0===e.data.code&&(t.successTip=e.data.data.Result)})).catch((function(e){console.log(e)}))},getLabel:function(e){var t=this;this.upgradeTarget=this.$target.find((function(e){return e===t.form.target})).value}},computed:s({},Object(o["c"])("table",["pageSize"])),created:function(){this.formInline.limit=this.pageSize[0],this.getData()}},d=c,m=(a("bd40"),a("2877")),f=Object(m["a"])(d,i,l,!1,null,"bfb1bc62",null);t["default"]=f.exports},bd40:function(e,t,a){"use strict";var i=a("f663"),l=a.n(i);l.a},f663:function(e,t,a){}}]);
//# sourceMappingURL=DeviceUpgrade.96290477.js.map