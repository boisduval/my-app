(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["mailBox"],{"2de0":function(e,t,a){},"84e2":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-collapse-transition",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticStyle:{"box-sizing":"border-box"}},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("收件箱列表查询")])]),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchForm,"label-width":"80px","label-position":"right"}},[a("el-form-item",{attrs:{label:"重要邮件:"}},[a("el-select",{model:{value:e.searchForm.IsImportance,callback:function(t){e.$set(e.searchForm,"IsImportance",t)},expression:"searchForm.IsImportance"}},e._l(e.options1,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),a("el-form-item",{attrs:{label:"状态:"}},[a("el-select",{model:{value:e.searchForm.IsRead,callback:function(t){e.$set(e.searchForm,"IsRead",t)},expression:"searchForm.IsRead"}},e._l(e.options2,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),a("el-form-item",{attrs:{label:"垃圾邮件:"}},[a("el-select",{model:{value:e.searchForm.IsSpam,callback:function(t){e.$set(e.searchForm,"IsSpam",t)},expression:"searchForm.IsSpam"}},e._l(e.options3,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),a("el-form-item",{attrs:{label:"删除:"}},[a("el-select",{model:{value:e.searchForm.IsDelete,callback:function(t){e.$set(e.searchForm,"IsDelete",t)},expression:"searchForm.IsDelete"}},e._l(e.options4,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),a("el-form-item",{attrs:{label:"邮件标题:"}},[a("el-input",{attrs:{placeholder:"请输入邮件标题"},model:{value:e.searchForm.LikeTitle,callback:function(t){e.$set(e.searchForm,"LikeTitle",t)},expression:"searchForm.LikeTitle"}})],1),a("el-form-item",{attrs:{label:"发件人:"}},[a("el-input",{attrs:{placeholder:"请输入发件人"},model:{value:e.searchForm.LikeFUserName,callback:function(t){e.$set(e.searchForm,"LikeFUserName",t)},expression:"searchForm.LikeFUserName"}})],1),a("el-form-item",{attrs:{label:"邮件内容:"}},[a("el-input",{attrs:{placeholder:"请输入邮件内容"},model:{value:e.searchForm.LikeMessage,callback:function(t){e.$set(e.searchForm,"LikeMessage",t)},expression:"searchForm.LikeMessage"}})],1),a("el-form-item",{attrs:{label:"邮件类型:"}},[a("el-select",{model:{value:e.searchForm.IsSend,callback:function(t){e.$set(e.searchForm,"IsSend",t)},expression:"searchForm.IsSend"}},e._l(e.options5,(function(e,t){return a("el-option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.searchForm.page=1,e.getData()}}},[e._v("查询")])],1)],1)],1),a("div",{staticStyle:{height:"20px",width:"100%"}})],1)]),a("el-card",{staticClass:"box-card visible"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("登录异常")])]),a("vxe-toolbar",{attrs:{custom:"",print:"",export:""},scopedSlots:e._u([{key:"buttons",fn:function(){return[a("el-button",{staticClass:"button-left",attrs:{type:"primary",size:"small"},on:{click:e.getUserList}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 写信 ")]),a("el-button",{staticClass:"button-left",attrs:{type:"primary",size:"small"},on:{click:e.deleteItems}},[a("i",{staticClass:"el-icon-delete"}),e._v(" 彻底删除 ")]),a("el-button",{staticClass:"button-left",attrs:{type:"primary",size:"small"},on:{click:function(t){e.isShow=!e.isShow}}},[a("i",{staticClass:"el-icon-search"}),e._v(" 模糊查询 ")]),a("el-button",{staticClass:"button-left",attrs:{type:"primary",size:"small"},on:{click:e.getData}},[a("i",{staticClass:"el-icon-refresh-right"}),e._v(" 刷新 ")])]},proxy:!0}])}),a("vxe-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"xTable",attrs:{data:e.tableData,border:"","export-config":e.exportConfig,"element-loading-background":"rgba(0, 0, 0, 0)","show-overflow":"",resizable:"",align:"center","highlight-hover-row":"","highlight-current-row":""}},[a("vxe-table-column",{attrs:{type:"checkbox",width:"50",fixed:"left"}}),a("vxe-table-column",{attrs:{type:"seq",width:"50",title:"序号",fixed:"left"}}),a("vxe-table-column",{attrs:{field:"SendName",title:"发件名称",width:"100",sortable:"","show-overflow":""}}),a("vxe-table-column",{attrs:{field:"Title",title:"邮件标题",width:"421","show-overflow":"",align:"left"}}),a("vxe-table-column",{attrs:{field:"SendTime",title:"距离时间",width:"100",sortable:"","show-overflow":""}}),a("vxe-table-column",{attrs:{field:"SendDay",title:"发件时间",width:"130",sortable:"","show-overflow":""}}),a("vxe-table-column",{attrs:{field:"IsRead",title:"状态",width:"100","show-overflow":""},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return["1"===o.IsRead?[a("el-tag",{attrs:{type:"success",size:"small"}},[e._v("已读")])]:[a("el-tag",{attrs:{type:"warning",size:"small"}},[e._v("未读")])]]}}])}),a("vxe-table-column",{attrs:{field:"IsImportance",title:"重要邮件",width:"100",sortable:"","show-overflow":""},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("i-switch",{attrs:{"true-color":"#13ce66",value:"1"===o.IsImportance},on:{"on-change":function(t){return e.setStatus(o,"IsImportance")}}},[a("span",{attrs:{slot:"open"},slot:"open"},[e._v("是")]),a("span",{attrs:{slot:"close"},slot:"close"},[e._v("否")])])]}}])}),a("vxe-table-column",{attrs:{field:"IsSpam",title:"垃圾邮件",width:"100",sortable:"","show-overflow":""},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("i-switch",{attrs:{"true-color":"#13ce66",value:"1"===o.IsSpam},on:{"on-change":function(t){return e.setStatus(o,"IsSpam")}}},[a("span",{attrs:{slot:"open"},slot:"open"},[e._v("是")]),a("span",{attrs:{slot:"close"},slot:"close"},[e._v("否")])])]}}])}),a("vxe-table-column",{attrs:{field:"IsDelete",title:"删除",width:"90",sortable:"","show-overflow":""},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[a("i-switch",{attrs:{"true-color":"#13ce66",value:"1"===o.IsDelete},on:{"on-change":function(t){return e.setStatus(o,"IsDelete")}}},[a("span",{attrs:{slot:"open"},slot:"open"},[e._v("是")]),a("span",{attrs:{slot:"close"},slot:"close"},[e._v("否")])])]}}])}),a("vxe-table-column",{attrs:{title:"操作",width:"318",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return["1"===o.IsSend?[a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.getMailInfo(o)}}},[e._v("详情")])]:[a("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.getMailInfo(o)}}},[e._v("详情")]),a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.replyDialog(o)}}},[e._v("回复")]),a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.repostDialog(o)}}},[e._v("转发")])]]}}])})],1),a("el-pagination",{attrs:{"current-page":e.searchForm.page,"page-sizes":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("Drawer",{attrs:{closable:!1,title:"邮件详情",draggable:"",width:"50"},model:{value:e.value4,callback:function(t){e.value4=t},expression:"value4"}},[a("p",{style:e.pStyle},[e._v("发件人")]),a("div",{staticClass:"demo-drawer-profile"},[e._v(" "+e._s(e.activeItem.FromUserName)+" ")]),a("Divider"),a("p",{style:e.pStyle},[e._v("收件人")]),a("div",{staticClass:"demo-drawer-profile"},[e._v(" "+e._s(e.activeItem.ToUserName)+" ")]),a("Divider"),a("p",{style:e.pStyle},[e._v("邮件标题")]),a("div",{staticClass:"demo-drawer-profile"},[e._v(" "+e._s(e.activeItem.Title)+" ")]),a("Divider"),a("p",{style:e.pStyle},[e._v("邮件内容")]),a("div",{staticClass:"demo-drawer-profile"},[a("div",{domProps:{innerHTML:e._s(e.activeItem.SendMessage)}})])],1),a("el-dialog",{attrs:{title:"写信",width:"70%","close-on-click-modal":!1,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("div",{staticStyle:{height:"500px",overflow:"auto"}},[a("el-form",{staticStyle:{"padding-right":"20px"},attrs:{"label-width":"80px","label-position":"right",model:e.sendForm}},[a("el-form-item",{attrs:{label:"收件人"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择或直接搜索",clearable:"",filterable:""},model:{value:e.sendForm.ToUserList,callback:function(t){e.$set(e.sendForm,"ToUserList",t)},expression:"sendForm.ToUserList"}},[a("Button",{attrs:{type:"text"},on:{click:e.selectAll}},[a("Icon",{attrs:{type:"md-done-all"}}),e._v(" 全选 ")],1),a("Button",{attrs:{type:"text"},on:{click:e.invert}},[a("Icon",{attrs:{type:"md-checkbox"}}),e._v(" 反选 ")],1),e._l(e.options,(function(e){return a("el-option",{key:e.SystemID,attrs:{label:e.Name,value:e.SystemID}})}))],2)],1),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.sendForm.Title,callback:function(t){e.$set(e.sendForm,"Title",t)},expression:"sendForm.Title"}})],1),a("el-form-item",{attrs:{label:"内容"}},[a("quill-editor",{ref:"myQuillEditor",staticClass:"editor",staticStyle:{"min-height":"400px"},attrs:{options:e.editorOption},on:{blur:function(t){return e.onEditorBlur(t)},focus:function(t){return e.onEditorFocus(t)},change:function(t){return e.onEditorChange(t)}},model:{value:e.sendForm.Msg,callback:function(t){e.$set(e.sendForm,"Msg",t)},expression:"sendForm.Msg"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.sendMail}},[e._v(" 提 交 ")]),a("el-button",{attrs:{size:"medium"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(" 取 消 ")])],1),e.spinShow?a("Spin",{attrs:{size:"large",fix:""}}):e._e()],1),a("el-dialog",{attrs:{title:"回复",width:"70%","close-on-click-modal":!1,visible:e.dialogFormReplyVisible},on:{"update:visible":function(t){e.dialogFormReplyVisible=t}}},[a("div",{staticStyle:{height:"500px",overflow:"auto"}},[a("el-form",{staticStyle:{"padding-right":"20px"},attrs:{"label-width":"80px","label-position":"right",model:e.replyForm}},[a("el-form-item",{attrs:{label:"收件人"}},[a("el-input",{attrs:{readonly:""},model:{value:e.replyForm.SendName,callback:function(t){e.$set(e.replyForm,"SendName",t)},expression:"replyForm.SendName"}})],1),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.replyForm.Title,callback:function(t){e.$set(e.replyForm,"Title",t)},expression:"replyForm.Title"}})],1),a("el-form-item",{attrs:{label:"内容"}},[a("quill-editor",{ref:"myQuillEditor",staticClass:"editor",staticStyle:{"min-height":"400px"},attrs:{options:e.editorOption},on:{blur:function(t){return e.onEditorBlur(t)},focus:function(t){return e.onEditorFocus(t)},change:function(t){return e.onEditorChange(t)}},model:{value:e.replyForm.Msg,callback:function(t){e.$set(e.replyForm,"Msg",t)},expression:"replyForm.Msg"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.reply}},[e._v(" 提 交 ")]),a("el-button",{attrs:{size:"medium"},on:{click:function(t){e.dialogFormReplyVisible=!1}}},[e._v(" 取 消 ")])],1),e.spinShow?a("Spin",{attrs:{size:"large",fix:""}}):e._e()],1)],1)],1)},s=[],l=a("2f62"),r=a("953d");a("a753"),a("8096"),a("14e1");function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function n(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(a,!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var m={components:{quillEditor:r["quillEditor"]},data:function(){return{searchForm:{AutoSystemID:"",page:1,limit:10,IsSend:!1,IsRead:100,IsImportance:100,IsSpam:100,IsDelete:100,LikeFUserName:"",LikeTitle:"",LikeMessage:""},isShow:!0,options1:[{label:"全部",value:100},{label:"是",value:1},{label:"否",value:0}],options2:[{label:"全部",value:100},{label:"已读",value:1},{label:"未读",value:0}],options3:[{label:"全部",value:100},{label:"是",value:1},{label:"否",value:0}],options4:[{label:"全部",value:100},{label:"已读",value:1},{label:"未读",value:0}],options5:[{label:"收件箱",value:!1},{label:"发件箱",value:!0}],tableData:[],loading:!1,exportConfig:{filename:"export",sheetName:"Sheet1",types:["csv","xlsx"]},count:0,addForm:{},dialogFormVisible:!1,selectedItems:[],mailStatus:{},value4:!1,pStyle:{fontSize:"16px",color:"rgba(0,0,0,0.85)",lineHeight:"24px",display:"block",marginBottom:"16px"},activeItem:{},sendForm:{},options:[],spinShow:!1,editorOption:{modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["image","video"]]},theme:"snow",placeholder:"请输入正文"},dialogFormReplyVisible:!1,replyForm:{AutoSystemID:"",Msg:"",Title:"",ToUserList:"",FromUserName:""}}},computed:n({},Object(l["c"])("table",["pageSize"]),{editor:function(){return this.$refs.myQuillEditor.quill}}),created:function(){this.searchForm.AutoSystemID=localStorage.getItem("AutoSystemID"),this.searchForm.limit=this.pageSize[0],this.getData()},methods:{handleSizeChange:function(e){this.searchForm.limit=e,this.getData()},handleCurrentChange:function(e){this.searchForm.page=e,this.getData()},getData:function(){var e=this;this.loading=!0;var t="/api/Mail/GetMailList";this.$axios.get(t,{params:this.searchForm}).then((function(t){0===t.data.code?(e.tableData=t.data.data,e.count=t.data.count,e.loading=!1):1===t.data.code&&e.$message.error(t.data.msg)})).catch((function(e){console.error(e)}))},setStatus:function(e,t){var a,o=this;"0"===e[t]?a="1":"1"===e[t]&&(a="0");var s={AutoSystemID:this.searchForm.AutoSystemID,data:[{SystemID:e.SystemID,Name:e.Title,ColumnName:t,Status:parseInt(a)}]},l="/api/Mail/SetMailStatus";this.$axios.post(l,s).then((function(e){0===e.data.code?(o.$message.success(e.data.msg),o.getData()):1===e.data.code&&o.$message.error(e.data.msg)})).catch((function(e){console.error(e)}))},getMailInfo:function(e){var t=this,a="/api/Mail/GetMailInfo";this.$axios.get(a,{params:{AutoSystemID:this.searchForm.AutoSystemID,SystemID:e.SystemID}}).then((function(e){0===e.data.code?(t.activeItem=e.data.data,t.value4=!0):1===e.data.code&&t.$message.error(e.data.msg)})).catch((function(e){console.error(e)}))},getUserList:function(){var e=this;this.dialogFormVisible=!0,this.spinShow=!0;var t="/api/Mail/GetUserList";this.$axios.get("".concat(t,"?AutoSystemID=").concat(this.searchForm.AutoSystemID)).then((function(t){0===t.data.code?(e.options=t.data.data,e.spinShow=!1):1===t.data.code&&e.$message.error(t.data.msg)})).catch((function(e){console.error(e)}))},selectAll:function(){var e=this;this.sendForm.ToUserList=[],this.options.map((function(t){e.sendForm.ToUserList.push(t.SystemID)}))},invert:function(){var e=this;this.options.map((function(t){var a=e.sendForm.ToUserList.indexOf(t.SystemID);a>-1?e.sendForm.ToUserList.splice(a,1):e.sendForm.ToUserList.push(t.SystemID)}))},onEditorReady:function(e){},onEditorBlur:function(){},onEditorFocus:function(){},onEditorChange:function(){},sendMail:function(){var e=this;this.sendForm.AutoSystemID=this.searchForm.AutoSystemID,this.sendForm.ToUserList=this.sendForm.ToUserList.toString();var t="/api/Mail/SendMail";this.$axios.post(t,this.sendForm).then((function(t){0===t.data.code?(e.$message.success(t.data.msg),e.dialogFormVisible=!1,e.sendForm={},e.getData()):1===t.data.code&&e.$message.error(t.data.msg)})).catch((function(e){console.error(e)}))},repostDialog:function(e){var t=this,a="/api/Mail/GetMailInfo";this.$axios.get(a,{params:{AutoSystemID:this.searchForm.AutoSystemID,SystemID:e.SystemID}}).then((function(e){0===e.data.code?(console.log(e.data.data),t.sendForm.Title=e.data.data.Title,t.sendForm.Msg=e.data.data.SendMessage,t.getUserList()):1===e.data.code&&t.$message.error(e.data.msg)})).catch((function(e){console.error(e)}))},replyDialog:function(e){var t=this;console.log(e),this.replyForm.SendName=e.SendName,this.replyForm.Title="回复: ".concat(e.Title),this.dialogFormReplyVisible=!0;var a="api/Mail/GetMailInfo";this.$axios.get("".concat(a,"?AutoSystemID=").concat(this.searchForm.AutoSystemID,"&SystemID=").concat(e.SystemID)).then((function(e){0===e.data.code?t.replyForm.ToUserList=e.data.data.FromUserSystemID:1===e.data.code&&t.$message.error(e.data.msg)})).catch((function(e){console.error(e)}))},reply:function(){var e=this;this.replyForm.AutoSystemID=this.searchForm.AutoSystemID;var t="/api/Mail/SendMail";this.$axios.post(t,this.replyForm).then((function(t){0===t.data.code?(e.$message.success(t.data.msg),e.dialogFormReplyVisible=!1,e.replyForm={},e.getData()):1===t.data.code&&e.$message.error(t.data.msg)})).catch((function(e){console.error(e)}))},deleteItems:function(){var e=this;this.selectedItems=this.$refs.xTable.getCheckboxRecords();var t=[];if(0===this.selectedItems.length)return this.$message.warning("请选择要删除的用户"),!1;this.selectedItems.map((function(e,a){t.push({SystemID:e.SystemID})})),console.log(this.selectedItems),this.$confirm("确定删除吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a="/api/Mail/ShiftDeleteMail";e.$axios.post(a,{AutoSystemID:e.searchForm.AutoSystemID,data:t}).then((function(t){if(0===t.data.code){e.$message.success(t.data.msg);var a=Math.ceil((e.count-e.selectedItems.length)/e.searchForm.limit),o=e.searchForm.page>a?a:e.searchForm.page;e.searchForm.page=o<1?1:o,e.getData()}else 1===t.data.code&&e.$message.error(t.data.msg)})).catch((function(e){console.error(e)}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))}}},u=m,d=(a("898f"),a("2877")),p=Object(d["a"])(u,o,s,!1,null,"39e865c3",null);t["default"]=p.exports},"898f":function(e,t,a){"use strict";var o=a("2de0"),s=a.n(o);s.a}}]);
//# sourceMappingURL=mailBox.04e90628.js.map